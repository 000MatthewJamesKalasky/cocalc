This implements computing active users across all users and in specific cohorts.

There is code duplication initially, but I'll refactor some of that out.
